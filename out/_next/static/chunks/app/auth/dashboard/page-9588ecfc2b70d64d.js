(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20],{22276:function(e,a,r){Promise.resolve().then(r.bind(r,29441))},29441:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return w}});var t=r(57437),o=r(2265),i=r(77280),s=r(24738),n=r(16394);let l=e=>{let{title:a,value:r,highlight:o=!1}=e;return(0,t.jsxs)("div",{className:"rounded-lg p-4 shadow-sm border bg-white "+(o?"border-primary-500":"border-gray-200"),children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:a}),(0,t.jsx)("p",{className:"mt-2 text-2xl font-semibold text-gray-800",children:r})]})};function d(e){let{summary:a}=e,{totalHorasTrabalho:r,metaHoras:o,sobreavisoHoras:i}=a;return(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,t.jsx)(l,{title:"Horas Trabalhadas (m\xeas)",value:r.toFixed(1)}),(0,t.jsx)(l,{title:"Meta Mensal",value:o.toString(),highlight:!0}),(0,t.jsx)(l,{title:"Horas Sobreaviso",value:i.toFixed(1)})]})}var c=r(9075),u=r(61994),h=r(27072),b=r(55428);function f(e){let{status:a,onEntrar:r,onSobreaviso:o,onSair:i,disabled:s,pulse:n=!1}=e,l="trabalhando"===a,d="sobreaviso_nao_acionado"===a||"sobreaviso_acionado"===a,{vibrateSuccess:f}=(0,b.$)(),m=(0,h.QS)({onSwipedLeft:()=>{(l||d)&&!s&&(f(),i())},onSwipedRight:()=>{l||d||s||(f(),r())},trackTouch:!0,delta:40});return(0,t.jsxs)("div",{className:"flex gap-3",...m,children:[(0,t.jsx)(c.E.button,{whileTap:{scale:.9},onClick:()=>{f(),r()},disabled:l||s,className:(0,u.Z)("flex-1 rounded py-3 font-semibold text-white shadow",l||s?"bg-gray-400":"bg-success-500",n&&!l?"animate-pulse":""),children:"Entrar"}),(0,t.jsx)(c.E.button,{whileTap:{scale:.9},onClick:()=>{f(),i()},disabled:!l||s,className:(0,u.Z)("flex-1 rounded py-3 font-semibold text-white shadow",!l||s?"bg-gray-400":"bg-error-500 animate-pulse"),children:"Sair"}),(0,t.jsx)(c.E.button,{whileTap:{scale:.9},onClick:()=>{f(),o()},disabled:l||s,className:(0,u.Z)("flex-1 rounded py-3 font-semibold text-white shadow",d?"bg-warning-500":"bg-info-500"),children:"sobreaviso_nao_acionado"===a?"Acionado":"Sobreaviso"})]})}var m=r(62891);function g(e){let{registro:a}=e,[r,i]=(0,o.useState)(()=>{let e=new Date;return(0,m.Z)(e,new Date("".concat(a.data,"T").concat(a.horaEntrada,":00")))});(0,o.useEffect)(()=>{let e=setInterval(()=>{i(e=>e+1)},1e3);return()=>clearInterval(e)},[]);let s="trabalho"===a.tipo?"Trabalhando…":"Sobreaviso…",n="trabalho"===a.tipo?"bg-primary-600":"bg-warning-500";return(0,t.jsxs)("div",{className:"".concat(n," text-white flex items-center justify-center py-2 rounded-lg mb-4"),children:[(0,t.jsxs)("span",{className:"mr-2",children:["⏱️ ",function(e){let a=Math.floor(e/3600).toString().padStart(2,"0"),r=Math.floor(e%3600/60).toString().padStart(2,"0"),t=Math.floor(e%60).toString().padStart(2,"0");return"".concat(a,":").concat(r,":").concat(t)}(r)]}),(0,t.jsx)("span",{children:s})]})}var p=r(66629),v=r(54754);let x=(0,r(30166).default)(()=>Promise.all([r.e(401),r.e(144)]).then(r.bind(r,12144)),{loadableGenerated:{webpack:()=>[12144]},ssr:!1,loading:()=>(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Carregando gr\xe1fico..."})});function w(){let{summary:e,chartData:a}=function(){let e=(0,i.F)(e=>e.registros),{summary:a,chartData:r}=(0,o.useMemo)(()=>{let a=new Date,r=0,t=0,o={};e.forEach(e=>{let i=new Date(e.data);if(!(0,n.Z)(i,a)||!e.horaSaida)return;let l=(0,s.PA)(e.horaEntrada,e.horaSaida),d=e.data;if(o[d]||(o[d]={trabalho:0,sobreaviso:0}),"trabalho"===e.tipo)r+=l,o[d].trabalho+=l;else{let a="sobreaviso_acionado"===e.tipo?1:.33;t+=l*a,o[d].sobreaviso+=l*a}});let i=Object.entries(o).sort((e,a)=>{let[r]=e,[t]=a;return r>t?1:-1}).map(e=>{let[a,{trabalho:r,sobreaviso:t}]=e;return{date:a,trabalho:r,sobreaviso:t}});return{summary:{totalHorasTrabalho:r,metaHoras:160,sobreavisoHoras:t},chartData:i}},[e]);return{summary:a,chartData:r}}(),{registros:r,addRegistro:l,updateRegistro:c}=(0,i.F)(),[u,h]=(0,o.useState)(!1),b=r[r.length-1],m="livre";return b&&!b.horaSaida&&(m="trabalho"===b.tipo?"trabalhando":"sobreaviso_nao_acionado"===b.tipo?"sobreaviso_nao_acionado":"sobreaviso_acionado"),(0,t.jsxs)("div",{className:"space-y-6",children:[b&&!b.horaSaida&&(0,t.jsx)(g,{registro:b}),(0,t.jsx)(f,{status:m,onEntrar:()=>{let e=new Date;l({id:(0,p.x0)(),usuarioId:"local",equipeId:"local",data:(0,v.Z)(e,"yyyy-MM-dd"),horaEntrada:(0,v.Z)(e,"HH:mm"),horaSaida:"",tipo:"trabalho"}),h(!0),setTimeout(()=>h(!1),700)},onSobreaviso:()=>{if("livre"===m){let e=new Date;l({id:(0,p.x0)(),usuarioId:"local",equipeId:"local",data:(0,v.Z)(e,"yyyy-MM-dd"),horaEntrada:(0,v.Z)(e,"HH:mm"),horaSaida:"",tipo:"sobreaviso_nao_acionado"})}else"sobreaviso_nao_acionado"===m&&(null==b?void 0:b.id)&&c(b.id,{tipo:"sobreaviso_acionado"})},onSair:()=>{b&&!b.horaSaida&&c(b.id,{horaSaida:(0,v.Z)(new Date,"HH:mm")})},pulse:u}),(0,t.jsx)(d,{summary:e}),(0,t.jsx)(x,{data:a})]})}},55428:function(e,a,r){"use strict";function t(){function e(e){var a;let r=navigator;null===(a=r.vibrate)||void 0===a||a.call(r,e)}return{vibrateSuccess:()=>e(30),vibrateError:()=>e([20,30,20])}}r.d(a,{$:function(){return t}})},24738:function(e,a,r){"use strict";function t(e){let[a,r]=e.split(":").map(Number);return 60*a+r}function o(e,a){let r=t(e),o=t(a);return o<r&&(o+=1440),(o-r)/60}r.d(a,{PA:function(){return o}})},46410:function(e,a,r){"use strict";let t;r.d(a,{I:function(){return l},db:function(){return d}});var o,i=r(738),s=r(43301),n=r(5978);t=null!==(o=window._firebaseApp)&&void 0!==o?o:(0,i.ZF)({apiKey:"AIzaSyAxDEIXRouCF63f9GK-ShqzTaKQhQIjvyw",authDomain:"controle-horarios-medicos.firebaseapp.com",projectId:"controle-horarios-medicos",storageBucket:"controle-horarios-medicos.firebasestorage.app",messagingSenderId:"977729325505",appId:"1:977729325505:web:82fe901b78d874ef81c740",measurementId:"YOUR_MEASUREMENT_ID"}),window._firebaseApp=t;let l=(0,s.v0)(t),d=(0,n.ad)(t)},77280:function(e,a,r){"use strict";r.d(a,{F:function(){return n}});var t=r(3011),o=r(89134),i=r(46410),s=r(5978);let n=(0,t.U)()((0,o.tJ)(e=>({registros:[],addRegistro:async a=>{e(e=>({registros:[...e.registros,a]}));try{await (0,s.pl)((0,s.JU)(i.db,"registros",a.id),a)}catch(e){console.error("Erro ao salvar no Firestore",e)}},updateRegistro:async(a,r)=>{e(e=>({registros:e.registros.map(e=>e.id===a?{...e,...r}:e)}));try{await (0,s.r7)((0,s.JU)(i.db,"registros",a),r)}catch(e){console.error("Erro ao atualizar no Firestore",e)}},deleteRegistro:async a=>{e(e=>({registros:e.registros.filter(e=>e.id!==a)}));try{await (0,s.oe)((0,s.JU)(i.db,"registros",a))}catch(e){console.error("Erro ao deletar no Firestore",e)}},setRegistros:a=>e({registros:a})}),{name:"registro-store"}))}},function(e){e.O(0,[358,237,996,553,754,349,184,971,117,744],function(){return e(e.s=22276)}),_N_E=e.O()}]);