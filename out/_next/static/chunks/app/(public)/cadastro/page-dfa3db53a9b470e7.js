(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[366],{98891:function(e,a,t){Promise.resolve().then(t.bind(t,79719))},79719:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return l}});var s=t(57437);t(2265);var r=t(29501),i=t(80845),o=t(75426),n=t(84832),d=t(27648);function l(){let{register:e,loading:a}=(0,n.a)(),{register:t,handleSubmit:l,formState:{errors:c,isSubmitting:u}}=(0,r.cI)({resolver:(0,i.F)(o.Tu)}),m=async a=>{await e(a.email,a.password)};return(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 p-4",children:(0,s.jsxs)("form",{onSubmit:l(m),className:"w-full max-w-sm space-y-4 rounded-lg bg-white p-6 shadow",children:[(0,s.jsx)("h1",{className:"text-center text-2xl font-semibold",children:"Criar conta"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"Email"}),(0,s.jsx)("input",{type:"email",...t("email"),className:"mt-1 w-full rounded border p-2"}),c.email&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.email.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"Senha"}),(0,s.jsx)("input",{type:"password",...t("password"),className:"mt-1 w-full rounded border p-2"}),c.password&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.password.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"Confirmar senha"}),(0,s.jsx)("input",{type:"password",...t("confirmPassword"),className:"mt-1 w-full rounded border p-2"}),c.confirmPassword&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:c.confirmPassword.message})]}),(0,s.jsx)("button",{type:"submit",disabled:u||a,className:"w-full rounded bg-primary-500 py-2 font-semibold text-white disabled:opacity-50",children:u?"Criando...":"Criar conta"}),(0,s.jsxs)("p",{className:"text-center text-sm",children:["J\xe1 possui conta?"," ",(0,s.jsx)(d.default,{href:"/login",className:"text-primary-600 hover:underline",children:"Entrar"})]})]})})}},84832:function(e,a,t){"use strict";t.d(a,{a:function(){return m}});var s=t(2265),r=t(46410),i=t(43301),o=t(64131),n=t(738),d=t(76834);function l(e,a){let t=function(){try{let e=(0,n.C6)().length>0?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"AIzaSyAxDEIXRouCF63f9GK-ShqzTaKQhQIjvyw",authDomain:"controle-horarios-medicos.firebaseapp.com",projectId:"controle-horarios-medicos",storageBucket:"controle-horarios-medicos.firebasestorage.app",messagingSenderId:"977729325505",appId:"1:977729325505:web:82fe901b78d874ef81c740",measurementId:"YOUR_MEASUREMENT_ID"});return d.getAnalytics(e)}catch(e){return console.warn("Analytics init falhou",e),null}}();t&&d.logEvent(t,e,a)}var c=t(5978),u=t(1186);function m(){let[e,a]=(0,s.useState)(null),[t,n]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,i.Aj)(r.I,async e=>{if(a(e),e){var t,s,i;let a=await e.getIdToken();o.Z.set("auth-token",a,{expires:1}),localStorage.setItem("user",JSON.stringify({uid:e.uid,email:e.email}));let n=(0,c.JU)(r.db,"users",e.uid);(await (0,c.QT)(n)).exists()||await (0,c.pl)(n,{email:e.email,nome:null!==(s=e.displayName)&&void 0!==s?s:"",role:"medico",createdAt:Date.now(),updatedAt:Date.now(),isActive:!0});let d=(await (0,c.QT)(n)).data();d&&!d.equipeId&&e.email&&await (0,u.Ol)(e.uid,e.email);let l=null!==(i=null===(t=(await (0,c.QT)(n)).data())||void 0===t?void 0:t.equipeId)&&void 0!==i?i:"";localStorage.setItem("equipeId",l)}else o.Z.remove("auth-token"),localStorage.removeItem("user");n(!1)}),t=(0,i.MX)(r.I,async e=>{if(e){let a=await e.getIdToken();o.Z.set("auth-token",a,{expires:1})}});return()=>{e(),t()}},[]);let d=(0,s.useCallback)(async(e,a)=>{await (0,i.e5)(r.I,e,a),l("login_success")},[]);return{user:e,loading:t,login:d,register:(0,s.useCallback)(async(e,a)=>{let t=await (0,i.Xb)(r.I,e,a);await (0,c.pl)((0,c.JU)(r.db,"users",t.user.uid),{email:e,nome:"",role:"medico",createdAt:Date.now(),updatedAt:Date.now(),isActive:!0}),l("register_success")},[]),logout:(0,s.useCallback)(async()=>{await (0,i.w7)(r.I),l("logout")},[]),resetPassword:(0,s.useCallback)(async e=>{await (0,i.LS)(r.I,e)},[])}}},46410:function(e,a,t){"use strict";let s;t.d(a,{I:function(){return d},db:function(){return l}});var r,i=t(738),o=t(43301),n=t(5978);s=null!==(r=window._firebaseApp)&&void 0!==r?r:(0,i.ZF)({apiKey:"AIzaSyAxDEIXRouCF63f9GK-ShqzTaKQhQIjvyw",authDomain:"controle-horarios-medicos.firebaseapp.com",projectId:"controle-horarios-medicos",storageBucket:"controle-horarios-medicos.firebasestorage.app",messagingSenderId:"977729325505",appId:"1:977729325505:web:82fe901b78d874ef81c740",measurementId:"YOUR_MEASUREMENT_ID"}),window._firebaseApp=s;let d=(0,o.v0)(s),l=(0,n.ad)(s);try{(0,n.ST)(l)}catch(e){e instanceof i.ZR&&("failed-precondition"===e.code?console.warn("A persist\xeancia do Firestore falhou. Isso geralmente ocorre se voc\xea tiver v\xe1rias abas abertas. Os dados n\xe3o ser\xe3o salvos offline nesta aba."):"unimplemented"===e.code&&console.warn("O navegador atual n\xe3o suporta persist\xeancia offline do Firestore."))}},1186:function(e,a,t){"use strict";t.d(a,{Cm:function(){return o},Lq:function(){return n},Ol:function(){return d}});var s=t(46410),r=t(66629),i=t(5978);async function o(e,a,t){let r=(0,i.JU)((0,i.hJ)(s.db,"equipes")),o={id:r.id,nome:a,adminId:e,membros:[e],invites:[],timezone:t,createdAt:Date.now(),isActive:!0};return await (0,i.pl)(r,o),await (0,i.r7)((0,i.JU)(s.db,"users",e),{equipeId:r.id,role:"admin_equipe",updatedAt:(0,i.Bt)()}),r.id}async function n(e,a){let t=(0,r.x0)(8);return await (0,i.r7)((0,i.JU)(s.db,"equipes",e),{invites:(0,i.vr)({email:a,code:t,status:"pending"})}),t}async function d(e,a){let t=(0,i.IO)((0,i.hJ)(s.db,"equipes"),(0,i.ar)("invites","array-contains",{code:a,status:"pending"})),r=await (0,i.PL)(t);if(r.empty)return console.error("Nenhum convite encontrado com o c\xf3digo:",a),!1;let o=r.docs[0],n=o.id,d=o.data().invites.map(e=>e.code===a?{...e,status:"accepted"}:e);return await (0,i.r7)(o.ref,{membros:(0,i.vr)(e),invites:d}),await (0,i.r7)((0,i.JU)(s.db,"users",e),{equipeId:n,role:"medico",updatedAt:(0,i.Bt)()}),!0}},75426:function(e,a,t){"use strict";t.d(a,{I_:function(){return o},Tu:function(){return i},pj:function(){return r}});var s=t(91115);let r=s.z.object({email:s.z.string().email({message:"Email inv\xe1lido"}),password:s.z.string().min(6,{message:"M\xednimo 6 caracteres"})}),i=r.extend({confirmPassword:s.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"As senhas n\xe3o coincidem",path:["confirmPassword"]});s.z.object({name:s.z.string().min(2,"Nome deve ter pelo menos 2 caracteres"),email:s.z.string().email("Email inv\xe1lido")});let o=s.z.object({data:s.z.string().regex(/^\d{4}-\d{2}-\d{2}$/,{message:"Data deve estar no formato YYYY-MM-DD"}),horaEntrada:s.z.string().regex(/^([01]?\d|2[0-3]):[0-5]\d$/,{message:"Hora inv\xe1lida"}),horaSaida:s.z.string().regex(/^([01]?\d|2[0-3]):[0-5]\d$/,{message:"Hora inv\xe1lida"}),tipo:s.z.enum(["trabalho","sobreaviso_acionado","sobreaviso_nao_acionado"]),observacoes:s.z.string().max(500).optional(),sobreavisoInicio:s.z.string().optional(),sobreavisoFim:s.z.string().optional(),sobreavisoAtivo:s.z.boolean().optional()}).refine(e=>{let[a,t]=e.horaEntrada.split(":").map(Number),[s,r]=e.horaSaida.split(":").map(Number),i=60*a+t,o=60*s+r;return o<i&&(o+=1440),o>i},{message:"Hora de sa\xedda n\xe3o pode ser anterior \xe0 entrada",path:["horaSaida"]});s.z.object({nome:s.z.string().min(1,"Nome \xe9 obrigat\xf3rio").max(100,"Nome muito longo"),descricao:s.z.string().max(500,"Descri\xe7\xe3o muito longa").optional()})}},function(e){e.O(0,[358,237,188,909,648,544,971,117,744],function(){return e(e.s=98891)}),_N_E=e.O()}]);